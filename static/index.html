<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <title>–ë–∏–±–∞</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover, user-scalable=no">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="mobile-web-app-capable" content="yes">

  <link rel="stylesheet" href="/static/style.css">
  <link rel="stylesheet" href="/static/fix-file-input.css">
</head>
<body>
  <div id="main">
    <!-- –ë—É—Ä–≥–µ—Ä-–º–µ–Ω—é –¥–ª—è –º–æ–±–∏–ª—å–Ω—ã—Ö -->
    <div id="mobileMenu" class="mobile-menu">
      <div class="mobile-menu-header">
        <div class="logo">
          <div class="logo-icon">üí¨</div>
          <div class="logo-text">–ë–∏–±–∞</div>
        </div>
        <button id="closeMobileMenu" class="close-mobile-menu">√ó</button>
      </div>
      <div class="mobile-menu-content">
        <h2>–ß–∞—Ç—ã</h2>
        <button id="mobileCreateChatBtn">+ –°–æ–∑–¥–∞—Ç—å —á–∞—Ç</button>
        <ul id="mobileChatList"></ul>
      </div>
      <div class="mobile-menu-footer">
        <button id="mobileContactsBtn">–ö–æ–Ω—Ç–∞–∫—Ç—ã</button>
        <button id="mobileProfileBtn">–ü—Ä–æ—Ñ–∏–ª—å</button>
        <button id="mobileLogoutBtn">–í—ã–π—Ç–∏</button>
      </div>
    </div>

    <!-- –û–≤–µ—Ä–ª–µ–π –¥–ª—è –º–æ–±–∏–ª—å–Ω–æ–≥–æ –º–µ–Ω—é -->
    <div id="mobileMenuOverlay" class="mobile-menu-overlay"></div>

    <!-- –ë—É—Ä–≥–µ—Ä-–∫–Ω–æ–ø–∫–∞ -->
    <button id="burgerMenuBtn" class="burger-menu-btn">‚ò∞</button>

    <div id="sidebar">
      <div class="logo">
        <div class="logo-icon">üí¨</div>
        <div class="logo-text">–ë–∏–±–∞</div>
      </div>
      <h2>–ß–∞—Ç—ã</h2>
      <button id="createChatBtn">+ –°–æ–∑–¥–∞—Ç—å —á–∞—Ç</button>
      <ul id="chatList"></ul>
      <div style="margin-top:auto; display:flex; flex-direction:column; gap:6px; padding-bottom:12px;">
        <button id="contactsBtn">–ö–æ–Ω—Ç–∞–∫—Ç—ã</button>
        <button id="profileBtn">–ü—Ä–æ—Ñ–∏–ª—å</button>
        <button id="logoutBtn">–í—ã–π—Ç–∏</button>
      </div>
    </div>
    <div id="content">
      <div id="chatHeader"><span id="chatTitle">–í—ã–±–µ—Ä–∏—Ç–µ —á–∞—Ç</span></div>
      <div id="messages"></div>
      <div class="input-container">
        <form id="msgForm" style="display:flex;" enctype="multipart/form-data">
          <label class="file-btn" title="–ü—Ä–∏–∫—Ä–µ–ø–∏—Ç—å —Ñ–∞–π–ª">
            üìé
            <input type="file" id="fileInput" accept="*/*">
          </label>
          <input type="text" id="msgInput" placeholder="–í–≤–µ–¥–∏—Ç–µ —Å–æ–æ–±—â–µ–Ω–∏–µ" autocomplete="off">
          <button type="submit">–û—Ç–ø—Ä–∞–≤–∏—Ç—å</button>
        </form>
      </div>
    </div>
  </div>

  <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —Å–æ–∑–¥–∞–Ω–∏—è —á–∞—Ç–∞ -->
  <div class="modal" id="newChatModal">
    <div class="modal-content">
      <span class="close" id="closeModal">√ó</span>
      <h3>–°–æ–∑–¥–∞—Ç—å —á–∞—Ç</h3>
      <form id="newChatForm">
        <input type="text" id="newChatName" placeholder="–ù–∞–∑–≤–∞–Ω–∏–µ —á–∞—Ç–∞" required><br><br>
        <div id="newChatContacts"></div>
        <button type="submit">–°–æ–∑–¥–∞—Ç—å</button>
      </form>
    </div>
  </div>

  <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –ø—Ä–æ—Ñ–∏–ª—è -->
  <div class="modal" id="profileModal">
    <div class="modal-content">
      <span class="close" id="closeProfile">√ó</span>
      <h3>–ü—Ä–æ—Ñ–∏–ª—å</h3>
      <div id="profileInfo"></div>
      <form id="profileForm">
        <input type="text" id="profileUsername" placeholder="–ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è" required><br>
        <input type="text" id="profileNickname" placeholder="–ù–∏–∫–Ω–µ–π–º (3-32 —Å–∏–º–≤–æ–ª–∞, —Ç–æ–ª—å–∫–æ –±—É–∫–≤—ã/—Ü–∏—Ñ—Ä—ã/_)"><br>
        <input type="email" id="profileEmail" placeholder="Email" required><br>
        <input type="password" id="profilePassword" placeholder="–ù–æ–≤—ã–π –ø–∞—Ä–æ–ª—å (–Ω–µ –º–µ–Ω—è—Ç—å ‚Äî –æ—Å—Ç–∞–≤–∏—Ç—å –ø—É—Å—Ç—ã–º)"><br>
        <button type="submit">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
      </form>
      <div id="profileMsg" style="color:green;"></div>
    </div>
  </div>

  <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –ø–æ–∏—Å–∫–∞ (–Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è) -->
  <div class="modal" id="searchModal">
    <div class="modal-content">
      <span class="close" id="closeSearch">√ó</span>
      <h3>–ü–æ–∏—Å–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π</h3>
      <form id="searchForm">
        <input type="text" id="searchInput" placeholder="–ò–º—è –∏–ª–∏ email">
        <button type="submit">–ù–∞–π—Ç–∏</button>
      </form>
      <ul id="searchResults"></ul>
    </div>
  </div>

  <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –∫–æ–Ω—Ç–∞–∫—Ç–æ–≤ -->
  <div class="modal" id="contactsModal">
    <div class="modal-content">
      <span class="close" id="closeContacts">√ó</span>
      <h3>–ö–æ–Ω—Ç–∞–∫—Ç—ã</h3>
      <div style="margin-bottom: 20px;">
        <h4>–î–æ–±–∞–≤–∏—Ç—å –∫–æ–Ω—Ç–∞–∫—Ç</h4>
        <form id="searchUserForm" style="display: flex; gap: 10px; margin-bottom: 10px;">
          <input type="text" id="searchUsername" placeholder="–í–≤–µ–¥–∏—Ç–µ –Ω–∏–∫–Ω–µ–π–º –∏–ª–∏ –∏–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è" style="flex: 1;">
          <button type="submit">–î–æ–±–∞–≤–∏—Ç—å</button>
        </form>
        <div id="searchResults" style="margin-top: 10px;"></div>
      </div>
      <div style="border-top: 1px solid #eee; padding-top: 20px;">
        <h4>–ú–æ–∏ –∫–æ–Ω—Ç–∞–∫—Ç—ã</h4>
        <ul id="contactsList"></ul>
      </div>
    </div>
  </div>

  <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è –≤—ã—Ö–æ–¥–∞ -->
  <div class="modal" id="logoutConfirmModal" style="display:none;"></div>

  <!-- –ö—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∞—è –±–∏–±–ª–∏–æ—Ç–µ–∫–∞ -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/tweetnacl/1.0.3/nacl-fast.min.js"></script>
  <script src="/static/app.js"></script>
</body>
</html>
